"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[59373],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>d});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),h=c(r),d=a,g=h["".concat(s,".").concat(d)]||h[d]||p[d]||o;return r?n.createElement(g,l(l({ref:t},u),{},{components:r})):n.createElement(g,l({ref:t},u))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,l=new Array(o);l[0]=h;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var c=2;c<o;c++)l[c]=r[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},21498:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>p});r(67294);var n=r(3905);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const i={title:"Upgrades"},s=void 0,c={unversionedId:"getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/upgrade-rancherd",id:"version-2.5/getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/upgrade-rancherd",title:"Upgrades",description:"Note: RancherD was an experimental feature available as part of Rancher v2.5.4 through v2.5.10 but is now deprecated and not available for recent releases.",source:"@site/versioned_docs/version-2.5/getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/upgrade-rancherd.md",sourceDirName:"getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux",slug:"/getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/upgrade-rancherd",permalink:"/v2.5/getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/upgrade-rancherd",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.5/getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/upgrade-rancherd.md",tags:[],version:"2.5",lastUpdatedAt:1663953084,formattedLastUpdatedAt:"Sep 23, 2022",frontMatter:{title:"Upgrades"},sidebar:"tutorialSidebar",previous:{title:"Rollbacks",permalink:"/v2.5/getting-started/installation-and-upgrade/other-installation-methods/install-rancher-on-linux/roll-back-rancherd"},next:{title:"Resources",permalink:"/v2.5/pages-for-subheaders/resources"}},u={},p=[{value:"Upgrading the Rancher Helm Chart without Upgrading the Underlying Cluster",id:"upgrading-the-rancher-helm-chart-without-upgrading-the-underlying-cluster",level:3},{value:"Upgrading Both Rancher and the Underlying Cluster",id:"upgrading-both-rancher-and-the-underlying-cluster",level:3}],h={toc:p};function d(e){var{components:t}=e,r=l(e,["components"]);return(0,n.kt)("wrapper",o(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}({},h,r),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")," RancherD was an experimental feature available as part of Rancher v2.5.4 through v2.5.10 but is now deprecated and not available for recent releases.")),(0,n.kt)("p",null,"When RancherD is upgraded, the Rancher Helm controller and the Fleet pods are upgraded."),(0,n.kt)("p",null,"During a RancherD upgrade, there is very little downtime, but it is possible that RKE2 may be down for a minute, during which you could lose access to Rancher."),(0,n.kt)("p",null,"When Rancher is installed with RancherD, the underlying Kubernetes cluster can't be upgraded from the Rancher UI. It needs to be upgraded using the RancherD CLI."),(0,n.kt)("h3",{id:"upgrading-the-rancher-helm-chart-without-upgrading-the-underlying-cluster"},"Upgrading the Rancher Helm Chart without Upgrading the Underlying Cluster"),(0,n.kt)("p",null,"To upgrade Rancher without upgrading the underlying Kubernetes cluster, follow these steps."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Before upgrading, we recommend that you should:"),(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Create a backup of the Rancher server using the ",(0,n.kt)("a",{parentName:"li",href:"/v2.5/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery/back-up-rancher"},"backup application.")),(0,n.kt)("li",{parentName:"ul"},"Review the known issues for the Rancher version you are upgrading to. The known issues are listed in the release notes on ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/rancher/rancher/releases"},"GitHub")," and on the ",(0,n.kt)("a",{parentName:"li",href:"https://forums.rancher.com/c/announcements/12"},"Rancher forums.")))),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Uninstall the chart with Helm:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"helm uninstall rancher\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Reinstall the Rancher chart with Helm. To install a specific Rancher version, use the ",(0,n.kt)("inlineCode",{parentName:"p"},"--version")," flag. For example:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"helm install rancher rancher-latest/rancher \\\n--namespace cattle-system \\\n--set hostname=rancher.my.org \\\n--version 2.5.1\n")))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Result:")," Rancher is upgraded to the new version."),(0,n.kt)("p",null,"If necessary, restore Rancher from backup by following ",(0,n.kt)("a",{parentName:"p",href:"/v2.5/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery/restore-rancher"},"these steps.")),(0,n.kt)("h3",{id:"upgrading-both-rancher-and-the-underlying-cluster"},"Upgrading Both Rancher and the Underlying Cluster"),(0,n.kt)("p",null,"Upgrade both RancherD and the underlying Kubernetes cluster by re-running the RancherD installation script."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Before upgrading, we recommend that you should:"),(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},"Create a backup of the Rancher server using the ",(0,n.kt)("a",{parentName:"li",href:"/v2.5/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery/back-up-rancher"},"backup application.")),(0,n.kt)("li",{parentName:"ul"},"Review the known issues for the Rancher version you are upgrading to. The known issues are listed in the release notes on ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/rancher/rancher/releases"},"GitHub")," and on the ",(0,n.kt)("a",{parentName:"li",href:"https://forums.rancher.com/c/announcements/12"},"Rancher forums.")))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"sudo curl -sfL https://get.rancher.io | sudo sh -\n")),(0,n.kt)("p",null,"To specify a specific version to upgrade to, use ",(0,n.kt)("inlineCode",{parentName:"p"},"INSTALL_RANCHERD_VERSION")," environment variable:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"curl -sfL https://get.rancher.io | INSTALL_RANCHERD_VERSION=v2.5.1 sh -\n")),(0,n.kt)("p",null,"Then launch the server:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"systemctl enable rancherd-server\nsystemctl start rancherd-server\n")),(0,n.kt)("p",null,"The upgrade can also be performed by manually installing the binary of the desired version."))}d.isMDXComponent=!0}}]);