"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[18445],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>d});var n=r(67294);function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,l=function(e,t){if(null==e)return{};var r,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=c(r),d=l,h=m["".concat(s,".").concat(d)]||m[d]||p[d]||i;return r?n.createElement(h,a(a({ref:t},u),{},{components:r})):n.createElement(h,a({ref:t},u))}));function d(e,t){var r=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=r.length,a=new Array(i);a[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:l,a[1]=o;for(var c=2;c<i;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},84562:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>c,toc:()=>p});r(67294);var n=r(3905);function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function a(e,t){if(null==e)return{};var r,n,l=function(e,t){if(null==e)return{};var r,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}const o={title:"Initialize Helm: Install the Tiller Service",description:"With Helm, you can create configurable deployments instead of using static files. In order to use Helm, the Tiller service needs to be installed on your cluster."},s=void 0,c={unversionedId:"pages-for-subheaders/helm2-helm-init",id:"version-2.0-2.4/pages-for-subheaders/helm2-helm-init",title:"Initialize Helm: Install the Tiller Service",description:"With Helm, you can create configurable deployments instead of using static files. In order to use Helm, the Tiller service needs to be installed on your cluster.",source:"@site/versioned_docs/version-2.0-2.4/pages-for-subheaders/helm2-helm-init.md",sourceDirName:"pages-for-subheaders",slug:"/pages-for-subheaders/helm2-helm-init",permalink:"/v2.0-v2.4/pages-for-subheaders/helm2-helm-init",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/pages-for-subheaders/helm2-helm-init.md",tags:[],version:"2.0-2.4",lastUpdatedAt:1663953084,formattedLastUpdatedAt:"Sep 23, 2022",frontMatter:{title:"Initialize Helm: Install the Tiller Service",description:"With Helm, you can create configurable deployments instead of using static files. In order to use Helm, the Tiller service needs to be installed on your cluster."},sidebar:"tutorialSidebar",previous:{title:"Troubleshooting",permalink:"/v2.0-v2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/kubernetes-rke/troubleshooting"},next:{title:"Troubleshooting",permalink:"/v2.0-v2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/helm-init/troubleshooting"}},u={},p=[{value:"Install Tiller on the Cluster",id:"install-tiller-on-the-cluster",level:3},{value:"Test your Tiller installation",id:"test-your-tiller-installation",level:3},{value:"Issues or errors?",id:"issues-or-errors",level:3},{value:"Next: Install Rancher",id:"next-install-rancher",level:3}],m={toc:p};function d(e){var{components:t}=e,r=a(e,["components"]);return(0,n.kt)("wrapper",i(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){l(e,t,r[t])}))}return e}({},m,r),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,'Helm is the package management tool of choice for Kubernetes. Helm "charts" provide templating syntax for Kubernetes YAML manifest documents. With Helm we can create configurable deployments instead of just using static files. For more information about creating your own catalog of deployments, check out the docs at ',(0,n.kt)("a",{parentName:"p",href:"https://helm.sh/"},"https://helm.sh/"),". To be able to use Helm, the server-side component ",(0,n.kt)("inlineCode",{parentName:"p"},"tiller")," needs to be installed on your cluster."),(0,n.kt)("p",null,"For systems without direct internet access, see ",(0,n.kt)("a",{parentName:"p",href:"/v2.0-v2.4/pages-for-subheaders/air-gapped-helm-cli-install"},"Helm - Air Gap")," for install details."),(0,n.kt)("p",null,"Refer to the ",(0,n.kt)("a",{parentName:"p",href:"/v2.0-v2.4/getting-started/installation-and-upgrade/resources/helm-version-requirements"},"Helm version requirements")," to choose a version of Helm to install Rancher."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")," The installation instructions assume you are using Helm 2. The instructions will be updated for Helm 3 soon. In the meantime, if you want to use Helm 3, refer to ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/ibrokethecloud/rancher-helm3"},"these instructions."))),(0,n.kt)("h3",{id:"install-tiller-on-the-cluster"},"Install Tiller on the Cluster"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Important:")," Due to an issue with Helm v2.12.0 and cert-manager, please use Helm v2.12.1 or higher.")),(0,n.kt)("p",null,"Helm installs the ",(0,n.kt)("inlineCode",{parentName:"p"},"tiller")," service on your cluster to manage charts. Since RKE enables RBAC by default we will need to use ",(0,n.kt)("inlineCode",{parentName:"p"},"kubectl")," to create a ",(0,n.kt)("inlineCode",{parentName:"p"},"serviceaccount")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"clusterrolebinding")," so ",(0,n.kt)("inlineCode",{parentName:"p"},"tiller")," has permission to deploy to the cluster."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Create the ",(0,n.kt)("inlineCode",{parentName:"li"},"ServiceAccount")," in the ",(0,n.kt)("inlineCode",{parentName:"li"},"kube-system")," namespace."),(0,n.kt)("li",{parentName:"ul"},"Create the ",(0,n.kt)("inlineCode",{parentName:"li"},"ClusterRoleBinding")," to give the ",(0,n.kt)("inlineCode",{parentName:"li"},"tiller")," account access to the cluster."),(0,n.kt)("li",{parentName:"ul"},"Finally use ",(0,n.kt)("inlineCode",{parentName:"li"},"helm")," to install the ",(0,n.kt)("inlineCode",{parentName:"li"},"tiller")," service")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-plain"},"kubectl -n kube-system create serviceaccount tiller\n\nkubectl create clusterrolebinding tiller \\\n  --clusterrole=cluster-admin \\\n  --serviceaccount=kube-system:tiller\n\nhelm init --service-account tiller\n\n# Users in China: You will need to specify a specific tiller-image in order to initialize tiller.\n# The list of tiller image tags are available here: https://dev.aliyun.com/detail.html?spm=5176.1972343.2.18.ErFNgC&repoId=62085.\n# When initializing tiller, you'll need to pass in --tiller-image\n\nhelm init --service-account tiller \\\n--tiller-image registry.cn-hangzhou.aliyuncs.com/google_containers/tiller:<tag>\n")),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")," This",(0,n.kt)("inlineCode",{parentName:"p"},"tiller"),"install has full cluster access, which should be acceptable if the cluster is dedicated to Rancher server. Check out the ",(0,n.kt)("a",{parentName:"p",href:"https://docs.helm.sh/using_helm/#role-based-access-control"},"helm docs")," for restricting ",(0,n.kt)("inlineCode",{parentName:"p"},"tiller")," access to suit your security requirements.")),(0,n.kt)("h3",{id:"test-your-tiller-installation"},"Test your Tiller installation"),(0,n.kt)("p",null,"Run the following command to verify the installation of ",(0,n.kt)("inlineCode",{parentName:"p"},"tiller")," on your cluster:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'kubectl -n kube-system  rollout status deploy/tiller-deploy\nWaiting for deployment "tiller-deploy" rollout to finish: 0 of 1 updated replicas are available...\ndeployment "tiller-deploy" successfully rolled out\n')),(0,n.kt)("p",null,"And run the following command to validate Helm can talk to the ",(0,n.kt)("inlineCode",{parentName:"p"},"tiller")," service:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'helm version\nClient: &version.Version{SemVer:"v2.12.1", GitCommit:"02a47c7249b1fc6d8fd3b94e6b4babf9d818144e", GitTreeState:"clean"}\nServer: &version.Version{SemVer:"v2.12.1", GitCommit:"02a47c7249b1fc6d8fd3b94e6b4babf9d818144e", GitTreeState:"clean"}\n')),(0,n.kt)("h3",{id:"issues-or-errors"},"Issues or errors?"),(0,n.kt)("p",null,"See the ",(0,n.kt)("a",{parentName:"p",href:"/v2.0-v2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/helm-init/troubleshooting"},"Troubleshooting")," page."),(0,n.kt)("h3",{id:"next-install-rancher"},(0,n.kt)("a",{parentName:"h3",href:"/v2.0-v2.4/pages-for-subheaders/helm-rancher"},"Next: Install Rancher")))}d.isMDXComponent=!0}}]);